{"ast":null,"code":"\"use strict\";\n\nObject.defineProperty(exports, \"__esModule\", {\n  value: true\n});\n\nvar rect_1 = require(\"../../models/rect\");\n\nvar text_1 = require(\"./text\");\n\nvar le5le_store_1 = require(\"le5le-store\");\n\nvar txtMarginTop = 5;\nvar minSize = 30;\n\nfunction imageIconRect(node) {\n  var x = node.rect.x;\n  var y = node.rect.y;\n  var width = node.rect.width;\n\n  if (node.imageWidth) {\n    width = node.imageWidth;\n    x += (node.rect.width - width) / 2;\n  }\n\n  var height = node.rect.height - node.textRect.height - txtMarginTop;\n\n  if (height < minSize) {\n    height = minSize;\n  }\n\n  var imgHeight = getImgHeight(node);\n\n  if (imgHeight !== minSize) {\n    height = imgHeight;\n    var txtHeight = node.rect.ey - node.textRect.y;\n\n    if (txtHeight < 0) {\n      txtHeight = 0;\n    }\n\n    y += (node.rect.height - txtHeight - height) / 2;\n  }\n\n  node.iconRect = new rect_1.Rect(x, y, width, height);\n  node.textRect.y = node.iconRect.ey + txtMarginTop;\n  node.textRect.ey = node.textRect.y + node.textRect.height;\n  node.fullIconRect = node.rect;\n}\n\nexports.imageIconRect = imageIconRect;\n\nfunction imageTextRect(node) {\n  var height = 0;\n  var lineHeight = node.font.fontSize * node.font.lineHeight;\n\n  if (node.textMaxLine) {\n    height = lineHeight * node.textMaxLine;\n  } else {\n    var canvas = le5le_store_1.Store.get('LT:offscreen');\n    var lines = text_1.getLines(canvas.getContext('2d'), text_1.getWords(node.text), node.rect.width);\n    height = lineHeight * lines.length;\n  }\n\n  var top = node.rect.ey - height;\n  var imgHeight = getImgHeight(node);\n\n  if (top - imgHeight - txtMarginTop < node.rect.y) {\n    top = node.rect.y + imgHeight + txtMarginTop;\n  }\n\n  node.textRect = new rect_1.Rect(node.rect.x, top, node.rect.width, height);\n  node.fullTextRect = node.rect;\n}\n\nexports.imageTextRect = imageTextRect;\n\nfunction getImgHeight(node) {\n  var imgHeight = minSize;\n\n  if (node.image) {\n    if (node.imageHeight > 0) {\n      imgHeight = node.imageHeight;\n    }\n  } else if (node.icon) {\n    if (node.iconSize > 0) {\n      imgHeight = node.iconSize;\n    }\n  }\n\n  return imgHeight;\n}","map":null,"metadata":{},"sourceType":"script"}