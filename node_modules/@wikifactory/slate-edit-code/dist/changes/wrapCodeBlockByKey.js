'use strict';

Object.defineProperty(exports, "__esModule", {
    value: true
});

require('slate');

var _utils = require('../utils');

/**
 * Wrap a block into a code block.
 */
function wrapCodeBlockByKey(opts, editor, key) {
    var value = editor.value;
    var document = value.document;


    var startBlock = document.getDescendant(key);
    var text = startBlock.text;

    // Remove all child
    editor.withoutNormalizing(function () {
        startBlock.nodes.forEach(function (node) {
            editor.removeNodeByKey(node.key);
        });
    });

    // Insert new text
    var toInsert = (0, _utils.deserializeCode)(opts, text);

    editor.withoutNormalizing(function () {
        toInsert.nodes.forEach(function (node, i) {
            editor.insertNodeByKey(startBlock.key, i, node);
        });
    });

    // Set node type
    editor.setNodeByKey(startBlock.key, {
        type: opts.containerType
    });

    return editor;
}

exports.default = wrapCodeBlockByKey;